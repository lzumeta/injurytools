<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="injurytools">
<title>Model Sports Injuries as Counts • injurytools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Sports Injuries as Counts">
<meta property="og:description" content="injurytools">
<meta property="og:image" content="https://lzumeta.github.io/injurytools/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">injurytools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/prepare-injury-data.html">Prepare data</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Describe data</h6>
    <a class="dropdown-item" href="../articles/estimate-epi-measures.html">Estimate summary statistics</a>
    <a class="dropdown-item" href="../articles/visualize-injury-data.html">Visualize data</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Model data</h6>
    <a class="dropdown-item" href="../articles/model-injury-data-i.html">Injuries as count data</a>
    <a class="dropdown-item" href="../articles/model-injury-data-ii.html">Injuries as time-to-event data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lzumeta/injurytools">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model Sports Injuries as Counts</h1>
            
            <h4 data-toc-skip class="date">2024-05-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lzumeta/injurytools/blob/HEAD/vignettes/model-injury-data-i.Rmd" class="external-link"><code>vignettes/model-injury-data-i.Rmd</code></a></small>
      <div class="d-none name"><code>model-injury-data-i.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lzumeta/injurytools" class="external-link">injurytools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atahk/pscl" class="external-link">pscl</a></span><span class="op">)</span></span>
<span><span class="co"># library(glmmTMB)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Example data</strong>: we continue exploring the cohort of
Liverpool Football Club male’s first team players over two consecutive
seasons, 2017-2018 and 2018-2019, scrapped from <a href="https://www.transfermarkt.com/" class="external-link uri">https://www.transfermarkt.com/</a> website<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;These data sets are provided for illustrative purposes.
We warn that they might not be accurate and could potentially include
discrepancies or incomplete information compared to what actually
occurred.&lt;/p&gt;"><sup>1</sup></a>.</p>
<p>This article provides some modelling approaches when injuries are
seen as count data.</p>
<p>First, the distribution of the count/rate variables is explored,
e.g. number of injuries and number of days lost per exposure time.
Afterwards, four different models are presented, that depending on the
distribution of the data, will provide a better fit to them due to the
distributional assumptions made by each of them.</p>
<div class="section level2">
<h2 id="exploring-the-distribution-of-injuries">Exploring the distribution of injuries<a class="anchor" aria-label="anchor" href="#exploring-the-distribution-of-injuries"></a>
</h2>
<p>We plot the histograms of the injury incidence and injury burden
variables for each season.</p>
<details><summary>
See the code to prepare the data
</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 17/18</span></span>
<span><span class="va">df_exposures1718</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_exp</a></span><span class="op">(</span>df_exposures0 <span class="op">=</span> </span>
<span>                                  <span class="va">raw_df_exposures</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="st">"17/18"</span><span class="op">)</span>,</span>
<span>                                player        <span class="op">=</span> <span class="st">"player_name"</span>,</span>
<span>                                date          <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>                                time_expo     <span class="op">=</span> <span class="st">"minutes_played"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonb <span class="op">=</span> <span class="fu"><a href="../reference/date2season.html">date2season</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_injuries1718</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_inj</a></span><span class="op">(</span>df_injuries0   <span class="op">=</span></span>
<span>                                 <span class="va">raw_df_injuries</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="st">"17/18"</span><span class="op">)</span>,</span>
<span>                               player         <span class="op">=</span> <span class="st">"player_name"</span>,</span>
<span>                               date_injured   <span class="op">=</span> <span class="st">"from"</span>,</span>
<span>                               date_recovered <span class="op">=</span> <span class="st">"until"</span><span class="op">)</span></span>
<span><span class="va">injd1718</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_all</a></span><span class="op">(</span>data_exposures <span class="op">=</span> <span class="va">df_exposures1718</span>,</span>
<span>                        data_injuries  <span class="op">=</span> <span class="va">df_injuries1718</span>,</span>
<span>                        exp_unit <span class="op">=</span> <span class="st">"matches_minutes"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 18/19</span></span>
<span><span class="va">df_exposures1819</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_exp</a></span><span class="op">(</span>df_exposures0 <span class="op">=</span> </span>
<span>                                  <span class="va">raw_df_exposures</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="st">"18/19"</span><span class="op">)</span>,</span>
<span>                                player        <span class="op">=</span> <span class="st">"player_name"</span>,</span>
<span>                                date          <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>                                time_expo     <span class="op">=</span> <span class="st">"minutes_played"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonb <span class="op">=</span> <span class="fu"><a href="../reference/date2season.html">date2season</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_injuries1819</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_inj</a></span><span class="op">(</span>df_injuries0   <span class="op">=</span> </span>
<span>                                 <span class="va">raw_df_injuries</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="st">"18/19"</span><span class="op">)</span>,</span>
<span>                               player         <span class="op">=</span> <span class="st">"player_name"</span>,</span>
<span>                               date_injured   <span class="op">=</span> <span class="st">"from"</span>,</span>
<span>                               date_recovered <span class="op">=</span> <span class="st">"until"</span><span class="op">)</span></span>
<span><span class="va">injd1819</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_all</a></span><span class="op">(</span>data_exposures <span class="op">=</span> <span class="va">df_exposures1819</span>,</span>
<span>                        data_injuries  <span class="op">=</span> <span class="va">df_injuries1819</span>,</span>
<span>                        exp_unit <span class="op">=</span> <span class="st">"matches_minutes"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## calculate injury summary statistics</span></span>
<span><span class="va">injds1718</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/injsummary.html">injsummary</a></span><span class="op">(</span><span class="va">injd1718</span>, quiet <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">injds1819</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/injsummary.html">injsummary</a></span><span class="op">(</span><span class="va">injd1819</span>, quiet <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">injds1718p</span> <span class="op">&lt;-</span> <span class="va">injds1718</span><span class="op">$</span><span class="va">playerwise</span></span>
<span><span class="va">injds1819p</span> <span class="op">&lt;-</span> <span class="va">injds1819</span><span class="op">$</span><span class="va">playerwise</span></span>
<span></span>
<span><span class="va">injdsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="st">"Season 17-18"</span> <span class="op">=</span> <span class="va">injds1718p</span>,</span>
<span>                    <span class="st">"Season 18-19"</span> <span class="op">=</span> <span class="va">injds1819p</span>,</span>
<span>                    .id <span class="op">=</span> <span class="st">"season"</span><span class="op">)</span></span></code></pre></div>
</details><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## plot</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">injdsp</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">injincidence</span>, fill <span class="op">=</span> <span class="va">season</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">season</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Number of players"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Incidence (number of injuries per 100 player-match)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Histogram of injury incidence in each season"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">injdsp</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">injburden</span>, fill <span class="op">=</span> <span class="va">season</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">season</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Number of players"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Burden (number of days lost due to injury per 100 player-match)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Histogram of injury burden in each season"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<details><summary>
Code for further plot specifications
</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theme_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="va">theme_counts</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">theme_counts</span></span></code></pre></div>
</details><p><img src="model-injury-data-i_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
<p>In the following, we use <code>injds1718p</code> data.</p>
</div>
<div class="section level2">
<h2 id="poisson-mixed-model">- Poisson (mixed) model<a class="anchor" aria-label="anchor" href="#poisson-mixed-model"></a>
</h2>
<p>We merge into the <code>injds1718p</code> data frame the
player-related information (i.e. <code>positionb</code>,
<code>age</code>, <code>assists</code>, <code>goals</code>,
<code>yellows</code> etc.) available in the
<code>raw_df_exposures</code> data frame.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 17/18</span></span>
<span><span class="va">df_exposures1718</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_exp</a></span><span class="op">(</span>df_exposures0 <span class="op">=</span> </span>
<span>                                  <span class="va">raw_df_exposures</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="st">"17/18"</span><span class="op">)</span>,</span>
<span>                                player        <span class="op">=</span> <span class="st">"player_name"</span>,</span>
<span>                                date          <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>                                time_expo     <span class="op">=</span> <span class="st">"minutes_played"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonb <span class="op">=</span> <span class="fu"><a href="../reference/date2season.html">date2season</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">injds1718p</span> <span class="op">&lt;-</span> <span class="va">injds1718p</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonb <span class="op">=</span> <span class="st">"2017/2018"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">## join to have info, such as position, age, citizenship etc.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df_exposures1718</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"player"</span> <span class="op">=</span> <span class="st">"player"</span>, </span>
<span>                                     <span class="st">"seasonb"</span> <span class="op">=</span> <span class="st">"seasonb"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">## create positionb column </span></span>
<span>  <span class="co">## (so that the categories are: Attack, Defender, Goalkeeper and Midfield)</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>positionb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split_i</a></span><span class="op">(</span><span class="va">position</span>, <span class="st">"_"</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## quit Goalkeepers</span></span>
<span><span class="va">injds1718p</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">injds1718p</span>, <span class="va">positionb</span> <span class="op">!=</span> <span class="st">"Goalkeeper"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To fit a Poisson regression model for injury incidence (considering
<code>positionb</code> as a covariate), we do:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incidence_glm_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">ninjuries</span> <span class="op">~</span> <span class="va">positionb</span>, <span class="co"># + offset(log(totalexpo))</span></span>
<span>                          offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">totalexpo</span><span class="op">)</span>,</span>
<span>                          data <span class="op">=</span> <span class="va">injds1718p</span>,</span>
<span>                          family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></span></code></pre></div>
<p>Or alternatively, we can use the <a href="https://glmmtmb.github.io/glmmTMB/reference/glmmTMB.html" class="external-link"><code>glmmTMB::glmmTMB</code></a>
function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># incidence_glm_pois2 &lt;- glmmTMB(formula = ninjuries ~ foot, </span></span>
<span><span class="co">#                                offset = log(totalexpo), </span></span>
<span><span class="co">#                                family = poisson(), data = injds1718p)</span></span>
<span><span class="co"># summary(incidence_glm_pois2)</span></span></code></pre></div>
<p>Besides, if we have repeated measurements as in <code>injdsp</code>,
we can fit a Mixed Model via:</p>
<details><summary>
Add more covariates to <code>injdsp</code> data frame
</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_exposures</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_data.html">prepare_exp</a></span><span class="op">(</span>df_exposures0 <span class="op">=</span> <span class="va">raw_df_exposures</span>,</span>
<span>                                player        <span class="op">=</span> <span class="st">"player_name"</span>,</span>
<span>                                date          <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>                                time_expo     <span class="op">=</span> <span class="st">"minutes_played"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonb <span class="op">=</span> <span class="fu"><a href="../reference/date2season.html">date2season</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">injdsp</span> <span class="op">&lt;-</span> <span class="va">injdsp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonb <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="st">"Season 17-18"</span>, <span class="st">"2017/2018"</span>, <span class="st">"2018/2019"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">## join to have info, such as position, age, citizenship etc.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df_exposures</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"player"</span> <span class="op">=</span> <span class="st">"player"</span>,</span>
<span>                                 <span class="st">"seasonb"</span> <span class="op">=</span> <span class="st">"seasonb"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">## create positionb column </span></span>
<span>  <span class="co">## (so that the categories are: Attack, Defender, Goalkeeper and Midfield)</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>positionb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split_i</a></span><span class="op">(</span><span class="va">position</span>, <span class="st">"_"</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incidence_glmm_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">ninjuries</span> <span class="op">~</span> <span class="va">positionb</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">player</span><span class="op">)</span>,</span>
<span>                             offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">totalexpo</span><span class="op">)</span>,</span>
<span>                             data <span class="op">=</span> <span class="va">injdsp</span>,</span>
<span>                             family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></span>
<span><span class="co"># incidence_glmm_pois2 &lt;- glmmTMB::glmmTMB(formula = ninjuries ~ positionb + (1 | player), </span></span>
<span><span class="co">#                                          offset = log(totalexpo),</span></span>
<span><span class="co">#                                          data = injdsp,</span></span>
<span><span class="co">#                                          family = poisson)</span></span></code></pre></div>
<p>We can do the analogue for the burden, e.g.:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">burden_glm_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">ndayslost</span> <span class="op">~</span> <span class="va">positionb</span>, offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">totalexpo</span><span class="op">)</span>, <span class="co">## or ~ foot</span></span>
<span>                       data <span class="op">=</span> <span class="va">injds1718p</span>,</span>
<span>                       family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></span></code></pre></div>
<p>As of now, lets stick with the model <code>burden_glm_pois</code> and
lets interpret the model output.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">burden_glm_pois</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = ndayslost ~ positionb, family = poisson, data = injds1718p, </span></span>
<span><span class="co">#&gt;     offset = log(totalexpo))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)       -3.81936    0.06651 -57.422   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; positionbDefender -0.03227    0.08893  -0.363    0.717    </span></span>
<span><span class="co">#&gt; positionbMidfield  1.01561    0.07780  13.054   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for poisson family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 2622.1  on 20  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 2327.1  on 18  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 2417.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></span></code></pre></div>
<p>The estimated coefficients are:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">burden_glm_pois</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">burden_glm_pois</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># (to report per 100 player-matches)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">estimate</th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">197.4757300</td>
<td align="right">172.8356815</td>
<td align="right">224.351527</td>
</tr>
<tr class="even">
<td align="left">positionbDefender</td>
<td align="right">0.9682499</td>
<td align="right">0.8137691</td>
<td align="right">1.153448</td>
</tr>
<tr class="odd">
<td align="left">positionbMidfield</td>
<td align="right">2.7610445</td>
<td align="right">2.3746045</td>
<td align="right">3.221913</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="negative-binomial-model">- Negative Binomial model<a class="anchor" aria-label="anchor" href="#negative-binomial-model"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">burden_glm_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></span><span class="op">(</span><span class="va">ndayslost</span> <span class="op">~</span> <span class="va">positionb</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">totalexpo</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                           data <span class="op">=</span> <span class="va">injds1718p</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">burden_glm_nb</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm.nb(formula = ndayslost ~ positionb + offset(log(totalexpo)), </span></span>
<span><span class="co">#&gt;     data = injds1718p, init.theta = 0.2625149285, link = log)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)        -2.9829     0.7404  -4.029  5.6e-05 ***</span></span>
<span><span class="co">#&gt; positionbDefender  -0.8857     1.0139  -0.874    0.382    </span></span>
<span><span class="co">#&gt; positionbMidfield   1.1416     1.0882   1.049    0.294    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for Negative Binomial(0.2625) family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 27.799  on 20  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 24.105  on 18  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 200.83</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Theta:  0.2625 </span></span>
<span><span class="co">#&gt;           Std. Err.:  0.0804 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  2 x log-likelihood:  -192.8270</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="zero-inflated-poisson-model">- Zero-inflated Poisson model<a class="anchor" aria-label="anchor" href="#zero-inflated-poisson-model"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">burden_zinfpois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">ndayslost</span> <span class="op">~</span> <span class="va">positionb</span> <span class="op">|</span> <span class="va">positionb</span>,</span>
<span>                             offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">totalexpo</span><span class="op">)</span>,</span>
<span>                             data <span class="op">=</span> <span class="va">injds1718p</span>,</span>
<span>                             link <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>                             dist <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>                             trace <span class="op">=</span> <span class="cn">FALSE</span>, EM <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## Or:</span></span>
<span><span class="co"># burden_zinfpois &lt;- glmmTMB::glmmTMB(formula = ndayslost ~ 1 +  positionb,</span></span>
<span><span class="co">#                                     offset = log(totalexpo),</span></span>
<span><span class="co">#                                     ziformula = ~ 1 + positionb,</span></span>
<span><span class="co">#                                     data = injds1718p,</span></span>
<span><span class="co">#                                     family = poisson)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">burden_zinfpois</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; zeroinfl(formula = ndayslost ~ positionb | positionb, data = injds1718p, </span></span>
<span><span class="co">#&gt;     offset = log(totalexpo), dist = "poisson", link = "logit", trace = FALSE, </span></span>
<span><span class="co">#&gt;     EM = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pearson residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -2.186 -1.385 -1.028  1.840 19.448 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Count model coefficients (poisson with log link):</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)       -3.38575    0.06652 -50.897   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; positionbDefender -0.21247    0.08893  -2.389   0.0169 *  </span></span>
<span><span class="co">#&gt; positionbMidfield  0.77309    0.07781   9.936   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Zero-inflation model coefficients (binomial with logit link):</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)        -0.2878     0.7638  -0.377    0.706</span></span>
<span><span class="co">#&gt; positionbDefender  -0.8109     1.1181  -0.725    0.468</span></span>
<span><span class="co">#&gt; positionbMidfield  -1.3217     1.3354  -0.990    0.322</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations in BFGS optimization: 9 </span></span>
<span><span class="co">#&gt; Log-likelihood: -929.5 on 6 Df</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="zero-inflated-negative-binomial-model">- Zero-inflated Negative Binomial model<a class="anchor" aria-label="anchor" href="#zero-inflated-negative-binomial-model"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">burden_zinfnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">ndayslost</span> <span class="op">~</span> <span class="va">positionb</span> <span class="op">|</span> <span class="va">positionb</span>,</span>
<span>                             offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">totalexpo</span><span class="op">)</span>,</span>
<span>                             data <span class="op">=</span> <span class="va">injds1718p</span>,</span>
<span>                             link <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>                             dist <span class="op">=</span> <span class="st">"negbin"</span>,</span>
<span>                             trace <span class="op">=</span> <span class="cn">FALSE</span>, EM <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## Or:</span></span>
<span><span class="co"># burden_zinfnb &lt;- glmmTMB::glmmTMB(ndayslost ~ 1 + positionb, offset = log(totalexpo),</span></span>
<span><span class="co">#                                      ziformula = ~ 1 + positionb,</span></span>
<span><span class="co">#                                      data = injds1718p,</span></span>
<span><span class="co">#                                      family = nbinom2)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">burden_zinfnb</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; zeroinfl(formula = ndayslost ~ positionb | positionb, data = injds1718p, </span></span>
<span><span class="co">#&gt;     offset = log(totalexpo), dist = "negbin", link = "logit", trace = FALSE, </span></span>
<span><span class="co">#&gt;     EM = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pearson residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -0.6477 -0.5554 -0.4596  0.2243  2.3967 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Count model coefficients (negbin with log link):</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)        -2.5214     0.6870  -3.670 0.000243 ***</span></span>
<span><span class="co">#&gt; positionbDefender  -1.1726     0.8795  -1.333 0.182449    </span></span>
<span><span class="co">#&gt; positionbMidfield   0.8246     0.9205   0.896 0.370326    </span></span>
<span><span class="co">#&gt; Log(theta)         -0.6520     0.4735  -1.377 0.168551    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Zero-inflation model coefficients (binomial with logit link):</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)        -0.5269     0.9143  -0.576    0.564</span></span>
<span><span class="co">#&gt; positionbDefender  -1.1295     1.6187  -0.698    0.485</span></span>
<span><span class="co">#&gt; positionbMidfield  -1.3186     1.6114  -0.818    0.413</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Theta = 0.521 </span></span>
<span><span class="co">#&gt; Number of iterations in BFGS optimization: 14 </span></span>
<span><span class="co">#&gt; Log-likelihood: -95.24 on 7 Df</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<p>Finally, lets compare the four models.</p>
<p>We compute the conditional predicted mean probabilities of each
model:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## pois</span></span>
<span><span class="co">## predprob: for each subj, prob of observing each value</span></span>
<span><span class="va">phat_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/predprob.html" class="external-link">predprob</a></span><span class="op">(</span><span class="va">burden_glm_pois</span><span class="op">)</span> </span>
<span><span class="va">phat_pois_mn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">phat_pois</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> </span>
<span><span class="co">## nb</span></span>
<span><span class="va">phat_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/predprob.html" class="external-link">predprob</a></span><span class="op">(</span><span class="va">burden_glm_nb</span><span class="op">)</span>           </span>
<span><span class="va">phat_nb_mn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">phat_nb</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> </span>
<span><span class="co">## zinfpois</span></span>
<span><span class="va">phat_zinfpois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/predprob.html" class="external-link">predprob</a></span><span class="op">(</span><span class="va">burden_zinfpois</span><span class="op">)</span>            </span>
<span><span class="va">phat_zinfpois_mn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">phat_zinfpois</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> </span>
<span><span class="co">## zinfnb</span></span>
<span><span class="va">phat_zinfnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/predprob.html" class="external-link">predprob</a></span><span class="op">(</span><span class="va">burden_zinfnb</span><span class="op">)</span>           </span>
<span><span class="va">phat_zinfnb_mn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">phat_zinfnb</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## put in a data frame</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">62</span>, length.out <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">df_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>phat_pois_mn     <span class="op">=</span> <span class="va">phat_pois_mn</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span>,</span>
<span>                       phat_nb_mn       <span class="op">=</span> <span class="va">phat_nb_mn</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span>,</span>
<span>                       phat_zinfpois_mn <span class="op">=</span> <span class="va">phat_zinfpois_mn</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span>,</span>
<span>                       phat_zinfnb_mn   <span class="op">=</span> <span class="va">phat_zinfnb_mn</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span>, </span>
<span>                       x<span class="op">=</span> <span class="va">idx</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"prob_type"</span>, value <span class="op">=</span> <span class="st">"value"</span>, <span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prob_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">prob_type</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And we display them over the histogram of the data to examine the
fits:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">injds1718p</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">injburden</span><span class="op">/</span><span class="fl">100</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">62</span>, length.out <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>                 col <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_probs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">value</span>, </span>
<span>                                  group <span class="op">=</span> <span class="va">prob_type</span>, col <span class="op">=</span> <span class="va">prob_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_probs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">value</span>, </span>
<span>                                 group <span class="op">=</span> <span class="va">prob_type</span>, col <span class="op">=</span> <span class="va">prob_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Injury burden"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Model:"</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative Binomial"</span>, <span class="st">"Poisson"</span>,</span>
<span>                                <span class="st">"Zero-Inflated Negative Binomial"</span>,</span>
<span>                                <span class="st">"Zero-Inflated Poisson"</span><span class="op">)</span>,</span>
<span>                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>, <span class="st">"chocolate"</span>, <span class="st">"purple"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Histogram of injury burden in 2017/2018\nwith conditional Poisson, NB, ZIP and ZINB Densities"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_counts</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2</span></span>
<span><span class="co">#&gt; 3.5.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use the `legend.position.inside` argument of `theme()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="model-injury-data-i_files/figure-html/unnamed-chunk-23-1.png" width="864"></p>
<p>Besides, we compute goodness of fit measures such as AIC, BIC and
deviance explained:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Poisson model"</span> <span class="op">=</span> <span class="va">burden_glm_pois</span>,</span>
<span>               <span class="st">"Negative binomial model"</span> <span class="op">=</span> <span class="va">burden_glm_nb</span>,</span>
<span>               <span class="st">"Zero-inflated Poisson model"</span> <span class="op">=</span> <span class="va">burden_zinfpois</span>,</span>
<span>               <span class="st">"Zero-inflated Negative Binomial model"</span> <span class="op">=</span> <span class="va">burden_zinfnb</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_gof</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">aic</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span>  <span class="va">bic</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="st">"zeroinfl"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">deviance</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">null_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">.</span><span class="op">~</span> <span class="op">-</span><span class="va">positionb</span><span class="op">)</span></span>
<span>    <span class="va">null_deviance</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">null_model</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">deviance</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">deviance</span></span>
<span>    <span class="va">null_deviance</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">null.deviance</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">dev_expl</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">null_deviance</span> <span class="op">-</span> <span class="va">deviance</span><span class="op">)</span><span class="op">/</span><span class="va">null_deviance</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span>res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>aic <span class="op">=</span> <span class="va">aic</span>, bic <span class="op">=</span> <span class="va">bic</span>, dev_expl <span class="op">=</span> <span class="va">dev_expl</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_gof</span> <span class="op">|&gt;</span>   </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="co">## arrange them according to dev_expl.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">dev_expl</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"Deviance Explained"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="52%">
<col width="10%">
<col width="10%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th align="left">Model</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">Deviance Explained</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Negative binomial model</td>
<td align="right">200.83</td>
<td align="right">205.00</td>
<td align="right">13.29</td>
</tr>
<tr class="even">
<td align="left">Poisson model</td>
<td align="right">2417.26</td>
<td align="right">2420.40</td>
<td align="right">11.25</td>
</tr>
<tr class="odd">
<td align="left">Zero-inflated Poisson model</td>
<td align="right">1871.10</td>
<td align="right">1877.36</td>
<td align="right">11.03</td>
</tr>
<tr class="even">
<td align="left">Zero-inflated Negative Binomial model</td>
<td align="right">204.48</td>
<td align="right">211.79</td>
<td align="right">2.77</td>
</tr>
</tbody>
</table>
<p>According to these measures, the Negative Binomial model
(<code>burden_glm_nb</code>) fits these data best.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://lzumeta.eus/" class="external-link">Lore Zumeta Olaskoaga</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
