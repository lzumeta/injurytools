<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prepare data in a standardized format — prepare_data • injurytools</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare data in a standardized format — prepare_data"><meta name="description" content="These are the data preprocessing functions provided by the injurytools
package, which involve:
setting exposure and injury and illness data in a standardized
format and
integrating both sources of data into an adequate data structure.
prepare_inj() and prepare_exp() set standardized names and
proper classes to the (key) columns in injury/illness and exposure data,
respectively. prepare_all() integrates both, standardized injury and
exposure data sets, and convert them into an injd S3 object
that has an adequate structure for further statistical analyses. See the
Prepare
Sports Injury Data vignette for details."><meta property="og:description" content="These are the data preprocessing functions provided by the injurytools
package, which involve:
setting exposure and injury and illness data in a standardized
format and
integrating both sources of data into an adequate data structure.
prepare_inj() and prepare_exp() set standardized names and
proper classes to the (key) columns in injury/illness and exposure data,
respectively. prepare_all() integrates both, standardized injury and
exposure data sets, and convert them into an injd S3 object
that has an adequate structure for further statistical analyses. See the
Prepare
Sports Injury Data vignette for details."><meta property="og:image" content="https://lzumeta.github.io/injurytools/logo.png"><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-17GBPW9WTZ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-17GBPW9WTZ');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">injurytools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/prepare-injury-data.html">Prepare data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Describe data</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate-epi-measures.html">Estimate summary statistics</a></li>
    <li><a class="dropdown-item" href="../articles/visualize-injury-data.html">Visualize data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model data</h6></li>
    <li><a class="dropdown-item" href="../articles/model-injury-data-i.html">Injuries as count data</a></li>
    <li><a class="dropdown-item" href="../articles/model-injury-data-ii.html">Injuries as time-to-event data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/lzumeta/injurytools"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Prepare data in a standardized format</h1>
      <small class="dont-index">Source: <a href="https://github.com/lzumeta/injurytools/blob/master/R/prepare_data.R" class="external-link"><code>R/prepare_data.R</code></a></small>
      <div class="d-none name"><code>prepare_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These are the data preprocessing functions provided by the <code>injurytools</code>
package, which involve:</p><ol><li><p>setting <strong>exposure</strong> and <strong>injury and illness data</strong> in a standardized
format and</p></li>
<li><p>integrating both sources of data into an adequate data structure.</p></li>
</ol><p><code>prepare_inj()</code> and <code>prepare_exp()</code> set standardized names and
proper classes to the (key) columns in injury/illness and exposure data,
respectively. <code>prepare_all()</code> integrates both, standardized injury and
exposure data sets, and convert them into an <code>injd</code> <strong>S3</strong> object
that has an adequate structure for further statistical analyses. See the
<a href="https://lzumeta.github.io/injurytools/articles/prepare-injury-data.html">Prepare
Sports Injury Data</a> vignette for details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prepare_inj</span><span class="op">(</span></span>
<span>  <span class="va">df_injuries0</span>,</span>
<span>  person_id <span class="op">=</span> <span class="st">"person_id"</span>,</span>
<span>  date_injured <span class="op">=</span> <span class="st">"date_injured"</span>,</span>
<span>  date_recovered <span class="op">=</span> <span class="st">"date_recovered"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">prepare_exp</span><span class="op">(</span></span>
<span>  <span class="va">df_exposures0</span>,</span>
<span>  person_id <span class="op">=</span> <span class="st">"person_id"</span>,</span>
<span>  date <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>  time_expo <span class="op">=</span> <span class="st">"time_expo"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">prepare_all</span><span class="op">(</span></span>
<span>  <span class="va">data_exposures</span>,</span>
<span>  <span class="va">data_injuries</span>,</span>
<span>  exp_unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minutes"</span>, <span class="st">"hours"</span>, <span class="st">"days"</span>, <span class="st">"matches_num"</span>, <span class="st">"matches_minutes"</span>,</span>
<span>    <span class="st">"activity_days"</span>, <span class="st">"seasons"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df-injuries-">df_injuries0<a class="anchor" aria-label="anchor" href="#arg-df-injuries-"></a></dt>
<dd><p>A data frame containing injury or illness information,
with columns referring to the athlete name/id, date of injury/illness and
date of recovery (as minimal data).</p></dd>


<dt id="arg-person-id">person_id<a class="anchor" aria-label="anchor" href="#arg-person-id"></a></dt>
<dd><p>Character referring to the column name storing sportsperson
(player, athlete) identification information.</p></dd>


<dt id="arg-date-injured">date_injured<a class="anchor" aria-label="anchor" href="#arg-date-injured"></a></dt>
<dd><p>Character referring to the column name where the
information about the date of injury or illness is stored.</p></dd>


<dt id="arg-date-recovered">date_recovered<a class="anchor" aria-label="anchor" href="#arg-date-recovered"></a></dt>
<dd><p>Character referring to the column name where the
information about the date of recovery is stored.</p></dd>


<dt id="arg-df-exposures-">df_exposures0<a class="anchor" aria-label="anchor" href="#arg-df-exposures-"></a></dt>
<dd><p>A data frame containing exposure information, with
columns referring to the sportsperson's name/id, date of exposure and the
total time of exposure of the corresponding data entry (as minimal data).</p></dd>


<dt id="arg-date">date<a class="anchor" aria-label="anchor" href="#arg-date"></a></dt>
<dd><p>Character referring to the column name where the exposure date
information is stored. Besides, the column must be of class
<a href="https://rdrr.io/r/base/Dates.html" class="external-link">Date</a> or
<a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a>/<a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a>. If it is
<code>integer</code>/<code>numeric</code>, it should refer to the year in which the
season started (e.g. <code>date</code> = 2015 to refer to the 2015/2016 season).</p></dd>


<dt id="arg-time-expo">time_expo<a class="anchor" aria-label="anchor" href="#arg-time-expo"></a></dt>
<dd><p>Character referring to the column name where the information
about the time of exposure in that corresponding date is stored.</p></dd>


<dt id="arg-data-exposures">data_exposures<a class="anchor" aria-label="anchor" href="#arg-data-exposures"></a></dt>
<dd><p>Exposure data frame with standardized column names, in
the same fashion that <code>prepare_exp()</code> returns.</p></dd>


<dt id="arg-data-injuries">data_injuries<a class="anchor" aria-label="anchor" href="#arg-data-injuries"></a></dt>
<dd><p>Injury data frame with standardized column names, in the
same fashion that <code>prepare_inj()</code> returns.</p></dd>


<dt id="arg-exp-unit">exp_unit<a class="anchor" aria-label="anchor" href="#arg-exp-unit"></a></dt>
<dd><p>Character defining the unit of exposure time ("minutes" the
default).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>prepare_inj()</code> returns a data frame in which the <strong>key
columns</strong> in injury/illness data are standardized and have a proper format.</p>
<p><code>prepare_exp()</code> returns a data frame in which the <strong>key
columns</strong> in exposure data are standardized and have a proper format.</p>
<p><code>prepare_all()</code> returns the <code>injd</code> <strong>S3</strong> object that
contains all the necessary information and a proper data structure to
perform further statistical analyses (e.g. calculate injury summary
statistics, visualize injury data).</p><ul><li><p>If <code>exp_unit</code> is "minutes" (the default), the columns
<code>tstart_min</code> and <code>tstop_min</code> are created which specify the time
to event (injury) values, the starting and stopping time of the interval,
respectively. That is the training time in minutes, that the sportsperson has
been at risk, until an injury/illness (or censorship) has occurred. For other
choices, <code>tstart_x</code> and <code>tstop_x</code> are also created according to
the <code>exp_unit</code> indicated (<code>x</code>, one of: <code>min</code>, <code>h</code>,
<code>match</code>, <code>minPlay</code>, <code>d</code>, <code>acd</code> or <code>s</code>). These
columns will be useful for survival analysis routines. See Note section.</p></li>
<li><p>It also creates <code>days_lost</code> column based on the difference between
<code>date_recovered</code> and <code>date_injured</code> in days. And if it does exist (in
the raw data) it overrides.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Depending on the unit of exposure, <code>tstart_x</code> and <code>tstop_x</code>
columns might have same values (e.g. if <code>exp_unit</code> = "matches_num" and the
player has not played any match between the corresponding period of time).
Please be aware of this before performing any survival analysis related
task.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">df_injuries</span> <span class="op">&lt;-</span> <span class="fu">prepare_inj</span><span class="op">(</span>df_injuries0   <span class="op">=</span> <span class="va">raw_df_injuries</span>,</span></span>
<span class="r-in"><span>                           person_id      <span class="op">=</span> <span class="st">"player_name"</span>,</span></span>
<span class="r-in"><span>                           date_injured   <span class="op">=</span> <span class="st">"from"</span>,</span></span>
<span class="r-in"><span>                           date_recovered <span class="op">=</span> <span class="st">"until"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df_exposures</span> <span class="op">&lt;-</span> <span class="fu">prepare_exp</span><span class="op">(</span>df_exposures0 <span class="op">=</span> <span class="va">raw_df_exposures</span>,</span></span>
<span class="r-in"><span>                            person_id     <span class="op">=</span> <span class="st">"player_name"</span>,</span></span>
<span class="r-in"><span>                            date          <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>                            time_expo     <span class="op">=</span> <span class="st">"minutes_played"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">injd</span> <span class="op">&lt;-</span> <span class="fu">prepare_all</span><span class="op">(</span>data_exposures <span class="op">=</span> <span class="va">df_exposures</span>,</span></span>
<span class="r-in"><span>                    data_injuries  <span class="op">=</span> <span class="va">df_injuries</span>,</span></span>
<span class="r-in"><span>                    exp_unit <span class="op">=</span> <span class="st">"matches_minutes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">injd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 19</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   person_id    t0         tf         date_injured date_recovered tstart    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> adam-lallana 2017-07-01 2019-06-30 2017-07-31   2017-11-25     2017-07-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> adam-lallana 2017-07-01 2019-06-30 2018-03-31   2018-05-13     2017-11-25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> adam-lallana 2017-07-01 2019-06-30 2018-09-04   2018-10-19     2018-05-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> adam-lallana 2017-07-01 2019-06-30 2018-11-09   2018-12-04     2018-10-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> adam-lallana 2017-07-01 2019-06-30 2019-01-06   2019-01-18     2018-12-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> adam-lallana 2017-07-01 2019-06-30 2019-04-01   2019-05-31     2019-01-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 13 more variables: tstop &lt;date&gt;, tstart_minPlay &lt;dbl&gt;, tstop_minPlay &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   status &lt;dbl&gt;, enum &lt;dbl&gt;, days_lost &lt;dbl&gt;, player_id &lt;fct&gt;, season &lt;fct&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   games_lost &lt;dbl&gt;, injury &lt;chr&gt;, injury_acl &lt;fct&gt;, injury_type &lt;fct&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   injury_severity &lt;fct&gt;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">injd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "injd"       "tbl_df"     "tbl"        "data.frame"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">injd</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> injd [108 × 19] (S3: injd/tbl_df/tbl/data.frame)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "unit_exposure")= chr "matches_minutes"</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://lzumeta.eus/" class="external-link">Lore Zumeta Olaskoaga</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

